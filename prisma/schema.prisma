generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:/data/dev.db"
}

model Customer {
  id          Int      @id @default(autoincrement())
  name        String
  phone       String
  email       String?
  vehicle     String
  vin         String?    // NEW
  mileageIn   String?    // NEW
  mileageOut  String?    // NEW
  quotes      Quote[]
}

model Quote {
  id             Int      @id @default(autoincrement())
  customerId     Int
  jobDescription String
  laborCost      Float
  totalCost      Float
  inspection     String?
  diagnostics    String?
  notes          String?
  signature      String?
  createdAt      DateTime @default(now())
  customer       Customer @relation(fields: [customerId], references: [id])
  parts          Part[]
}

model Part {
  id       Int    @id @default(autoincrement())
  quoteId  Int
  name     String
  price    Float
  quote    Quote  @relation(fields: [quoteId], references: [id])
}
model Invoice {
  id            Int      @id @default(autoincrement())
  customerName  String
  address       String
  phone         String
  email         String?
  date          DateTime @default(now())
  poNumber      String?
  soldBy        String?
  paymentMethod String   // 'Cash', 'Card', or 'Check'
  items         InvoiceItem[]
  subtotal      Float
  tax           Float
  total         Float
  signature     String?  // base64-encoded image
}

model InvoiceItem {
  id         Int     @id @default(autoincrement())
  invoiceId  Int
  qty        Int
  description String
  amount     Float
  invoice    Invoice @relation(fields: [invoiceId], references: [id])
}
